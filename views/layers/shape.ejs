<% function getStyles(settings) {
  let styles = ''
  if (settings) {
    if (settings.margin) {
      if (['1', '3', '13', '15', '2', '5', '11', '14'].includes(settings.position)) {
        if (['1', '2', '3', '5'].includes(settings.position)) {
          styles += `top:${settings.margin}px;`;
        } else if (['11', '13', '14', '15'].includes(settings.position)) {
          styles += `top:${-settings.margin}px;`;
        }
      }
      if (['1', '4', '7', '10', '13'].includes(settings.position)) {
        styles += `left:${settings.margin}px;`;
      }
      if (['3', '6', '9', '12', '15'].includes(settings.position)) {
        styles += `right:${settings.margin}px;`;
      }
    }
    if (settings.opacity) {
      styles += `opacity:${settings.opacity / 100};`
    }
    if (settings.rotate) {
      styles += `transform:rotate(${settings.rotate}deg);`
    }
  }
  return styles
}

function animationHeight(layer) {
  if (['square', 'frame', 'line'].includes(layer.content.value)) {
    return Math.abs((+layer.settings.layerSettings.width + +layer.settings.layerSettings.shapeStyles.thickness * 2) * Math.sin(Radians(+layer.settings.generalSettings.rotate))) +
            Math.abs((+layer.settings.layerSettings.height + +layer.settings.layerSettings.shapeStyles.thickness * 2) * Math.cos(Radians(+layer.settings.generalSettings.rotate)))
  } else if (layer.content.value === 'circle' || layer.content.value === 'rim') {
    return Math.sqrt(((+layer.settings.layerSettings.width + +layer.settings.layerSettings.shapeStyles.thickness * 2) ** 2 * Math.sin(Radians(+layer.settings.generalSettings.rotate)) ** 2) +
            ((+layer.settings.layerSettings.height + +layer.settings.layerSettings.shapeStyles.thickness * 2) ** 2 * Math.cos(Radians(+layer.settings.generalSettings.rotate)) ** 2))
  } else if (layer.content.value === 'triangle') {
    return (+layer.settings.layerSettings.height + +layer.settings.layerSettings.shapeStyles.thickness * 2) + (Math.abs((+layer.settings.layerSettings.height + +layer.settings.layerSettings.shapeStyles.thickness * 2) * (+layer.settings.generalSettings.rotate / 1000)))
  }
}

function animationWidth(layer) {
  if (['square', 'frame', 'line'].includes(layer.content.value)) {
    return Math.abs((+layer.settings.layerSettings.width + +layer.settings.layerSettings.shapeStyles.thickness * 2) * Math.cos(Radians(+layer.settings.generalSettings.rotate))) +
            Math.abs((+layer.settings.layerSettings.height + +layer.settings.layerSettings.shapeStyles.thickness * 2) * Math.sin(Radians(+layer.settings.generalSettings.rotate)))
  } else if (layer.content.value === 'circle' || layer.content.value === 'rim') {
    return Math.sqrt(((+layer.settings.layerSettings.width + +layer.settings.layerSettings.shapeStyles.thickness * 2) ** 2 * Math.cos(Radians(+layer.settings.generalSettings.rotate)) ** 2) +
            ((+layer.settings.layerSettings.height + +layer.settings.layerSettings.shapeStyles.thickness * 2) ** 2 * Math.sin(Radians(+layer.settings.generalSettings.rotate)) ** 2))
  } else if (layer.content.value === 'triangle') {
    return (+layer.settings.layerSettings.width + +layer.settings.layerSettings.shapeStyles.thickness * 2) + (Math.abs((+layer.settings.layerSettings.width + +layer.settings.layerSettings.shapeStyles.thickness * 2) * (+layer.settings.generalSettings.rotate / 1000)))
  }
}

function Radians(deg) {
  return deg * (Math.PI / 180)
}%>
<div
        style="width: 100%;height: 100%;"
<% if (layer.settings.animateIn && !preview){ %>
        animate-in="<%= layer.settings.animateIn %>"
        <% } %>
<% if (layer.settings.animateDuration){ %>
        animate-in-duration="<%= layer.settings.animateDuration %>s"
        <% } %>
        style="z-index: <%= layer.position %>;">
  <div class="inner-item shape" style="width: 100%;height: 100%;">
    <div
            id="shape<%= layer.settings.generalSettings.position ? layer.settings.generalSettings.position : '' %>"
            style="<%= getStyles(layer.settings.generalSettings)%>; text-align: center; position: relative;width: 100%;height: 100%;">
      <div
              class="<%= layer.content.value %>"
              style="transform: rotate(0 deg);background-size: contain;background-position: center;width: 100%;height: 100%;"></div>
    </div>
  </div>
</div>
